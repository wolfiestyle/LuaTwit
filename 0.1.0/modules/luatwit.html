<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>LuaTwit reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>LuaTwit</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
<li><a href="#Class_api">Class api </a></li>
</ul>


<h2>Modules</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><strong>luatwit</strong></li>
  <li><a href="../modules/luatwit.async.html">luatwit.async</a></li>
  <li><a href="../modules/luatwit.objects.html">luatwit.objects</a></li>
  <li><a href="../modules/luatwit.resources.html">luatwit.resources</a></li>
  <li><a href="../modules/luatwit.util.html">luatwit.util</a></li>
</ul>
<h2>Topics</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../topics/README.md.html">README</a></li>
</ul>
<h2>Examples</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../examples/async.lua.html">async.lua</a></li>
  <li><a href="../examples/authorize.lua.html">authorize.lua</a></li>
  <li><a href="../examples/followers.lua.html">followers.lua</a></li>
  <li><a href="../examples/gtk_client.lua.html">gtk_client.lua</a></li>
  <li><a href="../examples/repl.lua.html">repl.lua</a></li>
  <li><a href="../examples/set_avatar.lua.html">set_avatar.lua</a></li>
  <li><a href="../examples/timeline.lua.html">timeline.lua</a></li>
  <li><a href="../examples/tweet.lua.html">tweet.lua</a></li>
  <li><a href="../examples/user_info.lua.html">user_info.lua</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>luatwit</code></h1>
<p>Lua library for accessing the Twitter REST API v1.1</p>
<p></p>
    <h3>Info:</h3>
    <ul>
        <li><strong>License</strong>: MIT/X11</li>
        <li><strong>Author</strong>: darkstalker <https://github.com/darkstalker></li>
    </ul>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#load_keys">load_keys (...)</a></td>
	<td class="summary">Helper to load OAuth keys from text files.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#attach_file">attach_file (filename)</a></td>
	<td class="summary">Loads a file and prepares it for a multipart request.</td>
	</tr>
</table>
<h2><a href="#Class_api">Class api </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#api:raw_call">api:raw_call (method, path, args, mp, base_url, tname, rules, defaults, name)</a></td>
	<td class="summary">Generic call to the Twitter API.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#api:parse_json">api:parse_json (str, tname)</a></td>
	<td class="summary">Parses a JSON string and applies type metatables.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#api:start_login">api:start_login ()</a></td>
	<td class="summary">Begins the OAuth authorization.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#api:confirm_login">api:confirm_login (pin)</a></td>
	<td class="summary">Finishes the OAuth authorization.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#api:set_callback_handler">api:set_callback_handler (fn)</a></td>
	<td class="summary">Sets the callback handler function.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#api:http_request">api:http_request (args)</a></td>
	<td class="summary">Performs an HTTP request.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#api.new">api.new (args, threads, resources, objects)</a></td>
	<td class="summary">Creates a new <a href="../modules/luatwit.html#api">api</a> object with the supplied keys.</td>
	</tr>
</table>

<br/>
<br/>


    <h2><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "load_keys"></a>
    <strong>load_keys (...)</strong>
    </dt>
    <dd>
    Helper to load OAuth keys from text files.
 Key files are loaded with <code>pl.config</code>.
 It also accepts tables as arguments (useful when using <a href="http://www.lua.org/manual/5.1/manual.html#pdf-require">require</a>).



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">...</span>
           Filenames (config files) or tables with the keys to load.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Table with the keys found.
    </ol>




</dd>
    <dt>
    <a name = "attach_file"></a>
    <strong>attach_file (filename)</strong>
    </dt>
    <dd>
    Loads a file and prepares it for a multipart request.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">filename</span>
          File to be read.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
        On success, a table with the file contents. On error <code>nil</code>.</li>
        <li>
        The error message in case of failure.</li>
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/luatwit.resources.html#upload_media">luatwit.resources.upload_media</a>
    </ul>


</dd>
</dl>
    <h2><a name="Class_api"></a>Class api </h2>

        Class prototype that implements the API calls.
 Methods are created on demand from the definitions in the <code>self.resources</code> table (by default <a href="../modules/luatwit.resources.html#">luatwit.resources</a>).
    <dl class="function">
    <dt>
    <a name = "api:raw_call"></a>
    <strong>api:raw_call (method, path, args, mp, base_url, tname, rules, defaults, name)</strong>
    </dt>
    <dd>
    Generic call to the Twitter API.
 This is the backend method that performs all the API calls.



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">method</span>
            HTTP method.
        </li>
        <li><span class="parameter">path</span>
              API method path.
        </li>
        <li><span class="parameter">args</span>
              Table with the method arguments.
        </li>
        <li><span class="parameter">mp</span>
                <code>true</code> if the request should be done as multipart.
        </li>
        <li><span class="parameter">base_url</span>
          Base URL for the method endpoint.
        </li>
        <li><span class="parameter">tname</span>
             Result type name as defined in <code>resources</code>.
        </li>
        <li><span class="parameter">rules</span>
             Rules for checking args (with <a href="../modules/luatwit.util.html#check_args">luatwit.util.check_args</a>).
        </li>
        <li><span class="parameter">defaults</span>
          Default method arguments.
        </li>
        <li><span class="parameter">name</span>
              API method name. Used internally for building error messages.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
              A table with the decoded JSON data from the response, or <code>nil</code> on error.
              If the option <code>_raw</code> is set, instead returns an unprocessed JSON string.
              If the option <code>_async</code> or <code>_callback</code> is set, instead it returns a <a href="../modules/luatwit.async.html#future">luatwit.async.future</a> object.</li>
        <li>
        HTTP headers. On error, instead it will be a string or a <a href="../modules/luatwit.objects.html#error">luatwit.objects.error</a> describing the error.</li>
        <li>
              If the option <code>_raw</code> is set, the type name from <code>resources</code>.
              This value is needed to use <a href="../modules/luatwit.html#api:parse_json">api:parse_json</a> with the returned string.
              If an API error ocurred, instead it will be the HTTP headers of the request.</li>
    </ol>




</dd>
    <dt>
    <a name = "api:parse_json"></a>
    <strong>api:parse_json (str, tname)</strong>
    </dt>
    <dd>
    Parses a JSON string and applies type metatables.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">str</span>
           JSON string.
        </li>
        <li><span class="parameter">tname</span>
         Result type name as defined in <code>resources</code>.
              If set, the function will set type metatables.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        A table with the decoded JSON data, or <code>nil</code> on error.
    </ol>




</dd>
    <dt>
    <a name = "api:start_login"></a>
    <strong>api:start_login ()</strong>
    </dt>
    <dd>
    Begins the OAuth authorization.
 This method generates the URL that the user must visit to authorize the app and get the PIN needed for <a href="../modules/luatwit.html#api:confirm_login">api:confirm_login</a>.




    <h3>Returns:</h3>
    <ol>
        <li>
        Authorization URL.</li>
        <li>
        HTTP Authorization header.</li>
    </ol>




</dd>
    <dt>
    <a name = "api:confirm_login"></a>
    <strong>api:confirm_login (pin)</strong>
    </dt>
    <dd>
    Finishes the OAuth authorization.
 This method receives the PIN number obtained in the <a href="../modules/luatwit.html#api:start_login">api:start_login</a> step and authorizes the client to make API calls.



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">pin</span>
           PIN number obtained after the user succefully authorized the app.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
        An <code>access_token</code> object.</li>
        <li>
        HTTP Status line.</li>
        <li>
        HTTP result code.</li>
        <li>
        HTTP headers.</li>
    </ol>




</dd>
    <dt>
    <a name = "api:set_callback_handler"></a>
    <strong>api:set_callback_handler (fn)</strong>
    </dt>
    <dd>
    Sets the callback handler function.
 The callback handler is called after every async request that uses the <code>_callback</code> option. This function has to do the
 necessary setup to watch the future and send the result to the callback when it's ready.
 This way we can work with external event loops in a transparent way.



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">fn</span>
            Callback handler function. This is called as <code>fn(fut, callback)</code>, where <code>fut</code> is the result from an async
              API call and <code>callback</code> is the value passed in the request's <code>_callback</code> argument.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "api:http_request"></a>
    <strong>api:http_request (args)</strong>
    </dt>
    <dd>
    Performs an HTTP request.
 This method allows using the library features (like callback_handler) with regular HTTP requests.



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">args</span>
          Table with request arguments (url, body, _async, _callback).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Request response, or a <a href="../modules/luatwit.async.html#future">luatwit.async.future</a> object if the <code>_async</code> or <code>_callback</code> options were used.
    </ol>




</dd>
    <dt>
    <a name = "api.new"></a>
    <strong>api.new (args, threads, resources, objects)</strong>
    </dt>
    <dd>
    Creates a new <a href="../modules/luatwit.html#api">api</a> object with the supplied keys.
 An object created with only the consumer keys must call <a href="../modules/luatwit.html#api:start_login">api:start_login</a> and <a href="../modules/luatwit.html#api:confirm_login">api:confirm_login</a> to get the access token,
 otherwise it won't be able to make API calls.



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">args</span>
              Table with the OAuth keys (consumer_key, consumer_secret, oauth_token, oauth_token_secret).
        </li>
        <li><span class="parameter">threads</span>
           Number of threads for the async requests (default 1).
        </li>
        <li><span class="parameter">resources</span>
         Table with the API interface definition (default <a href="../modules/luatwit.resources.html#">luatwit.resources</a>).
        </li>
        <li><span class="parameter">objects</span>
           Table with the API objects definition (default <a href="../modules/luatwit.objects.html#">luatwit.objects</a>).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        New instance of the <a href="../modules/luatwit.html#api">api</a> class.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/luatwit.objects.html#access_token">luatwit.objects.access_token</a>
    </ul>


</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.3</a></i>
<i style="float:right;">Last updated 2015-04-15 14:12:57 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
